#N canvas 375 60 688 495 10;
#X obj 127 60 bng 15 250 50 0 empty empty empty 17 7 0 10 -228856 -1
-1;
#X obj 127 81 t b b, f 14;
#X text 178 27 Get the Pitch Weight Profile of a spectrum;
#X text 275 203 CTA;
#X text 305 172 MAXTA;
#X obj 157 245 print PTA;
#N canvas 0 387 450 300 (subpatch) 0;
#X array \$0-MAXTA 120 float 1;
#A 0 0 0 0 0 0 0 0 0 0 0 0.0235162 0 0.0261291 0 0.0293952 0.0185844
0.0335945 0.0206493 0 0.250637 0 0.103243 0.0470323 0.0282179 0.030974
0.0322491 0.0587904 0.0371688 0.0376239 0 0 0.501274 0 0 0 0.0564358
0.061948 0 0.117581 0 0.0752478 0 0 0.0929219 0 0 0 0.112872 0 0 0.705485
0 0 0 0 0.557532 0 0 0 0.67723 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0;
#X coords 0 1 119 0 240 140 1 0 0;
#X restore 367 302 graph;
#N canvas 0 387 450 300 (subpatch) 0;
#X array \$0-CTA 120 float 1;
#A 0 0 0 0 0 0 0 0 0 0 0 0.0235162 0 0.0261291 0 0.0293952 0.0185844
0.0335945 0.0206493 0 0.250637 0 0.103243 0.0470323 0.0282179 0.030974
0.0322491 0.0587904 0.0371688 0.0376239 0 0 0.501274 0 0 0 0.0564358
0.061948 0 0.117581 0 0.0752478 0 0 0.0929219 0 0 0 0.112872 0 0 0.235161
0 0 0 0 0.185844 0 0 0 0.225743 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0;
#X coords 0 1 119 0 240 140 1 0 0;
#X restore 105 302 graph;
#X msg 127 107 300 400 500;
#X obj 157 140 weight;
#X obj 354 73 bng 15 250 50 0 empty empty empty 17 7 0 10 -228856 -1
-1;
#X msg 354 128 300 400 500;
#X msg 452 127 1 0.9 0.8;
#X obj 354 95 trigger bang bang;
#X text 467 161 <= vanilla;
#N canvas 824 199 468 412 weight 0;
#X obj 250 35 inlet;
#X obj 141 35 inlet;
#N canvas 544 79 376 391 YL 0;
#X obj 237 189 list store;
#X obj 124 97 until;
#X obj 124 210 list store;
#X obj 124 125 f;
#X obj 152 125 + 1;
#X msg 171 97 0, f 2;
#X msg 124 154 get \$1 1;
#X obj 124 185 t a a;
#X obj 114 295 list store, f 16;
#X msg 124 266 append \$1;
#X obj 294 38 inlet;
#X obj 67 40 inlet;
#X obj 114 331 outlet;
#X obj 67 331 outlet;
#X obj 67 70 trigger list bang bang bang list;
#N canvas 580 226 601 472 get-Lth 0;
#X obj 133 48 inlet;
#X obj 272 408 outlet;
#X obj 154 184 exp;
#X obj 75 247 expr (3.64 * pow($f1 \, -0.8));
#X obj 154 161 expr -0.6 * pow($f1 - 3.3 \, 2);
#X obj 343 160 expr (pow(10 \, -3) * pow($f1 \, 4));
#X obj 133 109 trigger float float float;
#X obj 154 206 * 6.5;
#X obj 178 299 expr $f1 - $f2 + $f3;
#X text 147 300 Lth;
#X obj 133 76 / 1000;
#X obj 272 346 expr $f2 - $f1;
#X obj 375 59 inlet;
#X text 423 112 dB;
#X obj 373 113 rmstodb;
#X text 280 378 YL;
#X connect 0 0 10 0;
#X connect 2 0 7 0;
#X connect 3 0 8 0;
#X connect 4 0 2 0;
#X connect 5 0 8 2;
#X connect 6 0 3 0;
#X connect 6 1 4 0;
#X connect 6 2 5 0;
#X connect 7 0 8 1;
#X connect 8 0 11 0;
#X connect 10 0 6 0;
#X connect 11 0 1 0;
#X connect 12 0 14 0;
#X connect 14 0 11 1;
#X restore 124 239 pd get-Lth;
#X connect 0 0 15 1;
#X connect 1 0 3 0;
#X connect 2 0 15 0;
#X connect 2 1 1 1;
#X connect 3 0 4 0;
#X connect 3 0 6 0;
#X connect 4 0 3 1;
#X connect 5 0 3 1;
#X connect 6 0 7 0;
#X connect 7 0 2 0;
#X connect 7 1 0 0;
#X connect 8 0 12 0;
#X connect 9 0 8 0;
#X connect 10 0 0 1;
#X connect 11 0 14 0;
#X connect 14 0 13 0;
#X connect 14 1 8 0;
#X connect 14 2 1 0;
#X connect 14 3 8 1;
#X connect 14 3 5 0;
#X connect 14 4 2 1;
#X connect 15 0 9 0;
#X restore 223 155 pd YL;
#X text 265 154 <= Auditory Levels;
#X obj 141 267 list store;
#X msg 223 205 append \$1;
#X obj 141 322 outlet;
#X obj 141 75 t b b l b;
#N canvas 254 23 664 794 PTA 0;
#X obj 86 148 until;
#X obj 233 38 inlet;
#X obj 86 38 inlet;
#N canvas 301 23 368 336 set-array 0;
#X obj 147 66 inlet;
#X obj 174 195 array define yl_\$0;
#X obj 174 122 list length;
#X obj 174 143 change;
#X msg 174 168 resize \$1;
#X obj 147 94 t l l;
#X obj 147 221 array set yl_\$0;
#X connect 0 0 5 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 1 0;
#X connect 5 0 6 0;
#X connect 5 1 2 0;
#X restore 233 98 pd set-array;
#N canvas 301 23 363 323 set-array 0;
#X obj 85 52 inlet;
#X obj 214 108 list length;
#X obj 214 129 change;
#X msg 214 177 resize \$1;
#X obj 214 204 array define hz_\$0;
#X obj 149 237 array set hz_\$0;
#X obj 85 80 trigger bang list list;
#X obj 85 286 outlet;
#X obj 235 151 v size_\$0;
#X connect 0 0 6 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 0 8 0;
#X connect 3 0 4 0;
#X connect 6 0 7 0;
#X connect 6 1 5 0;
#X connect 6 2 1 0;
#X restore 86 74 pd set-array;
#X obj 86 100 v size_\$0;
#X obj 139 146 v i_\$0;
#X obj 120 251 until;
#X obj 86 202 v size_\$0;
#X obj 243 309 sel 1;
#N canvas 374 23 390 156 hz2erb 0;
#X obj 75 67 expr 11.17 * log(($f1+0.312)/($f1+14.675)) + 43;
#X obj 75 40 inlet;
#X obj 75 94 outlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X restore 408 385 pd hz2erb;
#X obj 408 357 expr hz_\$0[i_\$0] * 0.001;
#X obj 243 332 trigger bang bang, f 28;
#N canvas 374 23 390 156 hz2erb 0;
#X obj 75 67 expr 11.17 * log(($f1+0.312)/($f1+14.675)) + 43;
#X obj 75 40 inlet;
#X obj 75 94 outlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X restore 243 385 pd hz2erb;
#X obj 243 357 expr hz_\$0[j_\$0] * 0.001, f 25;
#X obj 243 414 expr dif_\$0 = abs($f1 - $f2);
#X obj 243 445 < 3;
#X obj 243 466 sel 1;
#X obj 243 534 expr sum_\$0 = sum_\$0 + pow(10 \, $f1/20);
#X obj 73 403 expr 20 * log10(sum_\$0);
#X obj 73 425 max 0;
#X obj 86 123 t f b;
#X msg 168 228 0;
#X obj 168 250 v j_\$0;
#X msg 139 124 0;
#X obj 73 472 max 0;
#X obj 243 504 expr yl_\$0[j_\$0] - kM_\$0 * dif_\$0;
#X obj 73 450 expr yl_\$0[i_\$0] - $f1;
#X obj 73 716 outlet;
#X obj 193 203 v sum_\$0;
#X msg 193 179 0;
#X obj 120 273 expr j_\$0 = j_\$0 + 1 \; j_\$0 != i_\$0;
#X obj 103 353 expr i_\$0 = i_\$0 + 1;
#X obj 86 173 t b b;
#X obj 73 521 expr 1-exp(-$f1/15);
#X text 37 473 Eq.6;
#X text 39 425 Eq.5;
#X text 37 521 Eq.7;
#X obj 432 414 v dif_\$0;
#X obj 86 224 t b b f b;
#X obj 155 630 ftom;
#X obj 73 567 trigger float bang float, f 28;
#X obj 155 608 expr hz_\$0[i_\$0];
#X obj 155 651 expr rint($f1-12);
#X obj 155 673 expr PTA_\$0[$f1] = PTA_\$0[$f1] + $f2;
#X connect 0 0 33 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 21 0;
#X connect 7 0 31 0;
#X connect 8 0 39 0;
#X connect 9 0 12 0;
#X connect 10 0 15 1;
#X connect 11 0 10 0;
#X connect 12 0 14 0;
#X connect 12 1 11 0;
#X connect 13 0 15 0;
#X connect 14 0 13 0;
#X connect 15 0 16 0;
#X connect 16 0 17 0;
#X connect 17 0 26 0;
#X connect 19 0 20 0;
#X connect 20 0 27 0;
#X connect 21 0 0 0;
#X connect 21 1 24 0;
#X connect 22 0 23 0;
#X connect 24 0 6 0;
#X connect 25 0 34 0;
#X connect 26 0 18 0;
#X connect 27 0 25 0;
#X connect 30 0 29 0;
#X connect 31 1 9 0;
#X connect 33 0 8 0;
#X connect 33 1 30 0;
#X connect 34 0 41 0;
#X connect 39 0 32 0;
#X connect 39 1 19 0;
#X connect 39 2 7 0;
#X connect 39 3 22 0;
#X connect 40 0 43 0;
#X connect 41 0 28 0;
#X connect 41 1 42 0;
#X connect 41 2 44 1;
#X connect 42 0 40 0;
#X connect 43 0 44 0;
#X restore 223 180 pd PTA;
#X text 65 301 (Eq.7) Audibility Ap(P) =====>, f 12;
#N canvas 661 316 672 502 CTA_MAXTA 0;
#X obj 260 123 until;
#X obj 260 158 f;
#X obj 293 158 + 1;
#X msg 303 122 0;
#X obj 260 97 t f b;
#X obj 260 69 v ncats_\$0;
#X msg 314 226 10;
#X obj 314 253 until;
#X obj 314 302 ftom;
#X obj 260 198 t f f;
#X obj 491 229 + 12;
#X obj 491 253 mtof;
#X obj 197 25 inlet;
#X obj 197 69 t b b b;
#X obj 216 405 array get MAXTA_\$0;
#X obj 91 406 array get CTA_\$0;
#X obj 216 434 outlet;
#X obj 91 434 outlet;
#X obj 260 353 expr MAXTA_\$0[$f1] = max(CTA_\$0[$f1] \, PTA_\$0[$f1])
\; CTA_\$0[$f1] = (sum_\$0*sum_\$0)/kT_\$0;
#X msg 381 223 0;
#X obj 381 253 v n_\$0;
#X obj 431 253 v sum_\$0;
#X obj 314 199 trigger bang bang float;
#X obj 314 325 expr sum_\$0 = sum_\$0 + sqrt(PTA_\$0[rint($f1)-12]/n_\$0)
;
#X obj 355 56 expr ((n_\$0 = n_\$0 + 1) * $f2) - 12;
#X obj 314 279 expr (n_\$0 = n_\$0 + 1) * $f2;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 0 9 0;
#X connect 2 0 1 1;
#X connect 3 0 1 1;
#X connect 4 0 0 0;
#X connect 4 1 3 0;
#X connect 5 0 4 0;
#X connect 6 0 7 0;
#X connect 7 0 25 0;
#X connect 8 0 23 0;
#X connect 9 0 18 0;
#X connect 9 1 22 0;
#X connect 10 0 11 0;
#X connect 11 0 25 1;
#X connect 12 0 13 0;
#X connect 13 0 15 0;
#X connect 13 1 14 0;
#X connect 13 2 5 0;
#X connect 14 0 16 0;
#X connect 15 0 17 0;
#X connect 19 0 20 0;
#X connect 19 0 21 0;
#X connect 22 0 6 0;
#X connect 22 1 19 0;
#X connect 22 2 10 0;
#X connect 25 0 8 0;
#X restore 225 267 pd CTA_MAXTA;
#N canvas 442 88 477 310 init 0;
#X obj 281 170 loadbang;
#X msg 281 196 12;
#X obj 281 221 v kM_\$0;
#X obj 240 120 array define MAXTA_\$0 120;
#X obj 240 72 array define CTA_\$0 120;
#X obj 338 239 v ncats_\$0;
#X msg 338 194 12;
#X obj 338 216 * 10;
#X obj 242 245 v kT_\$0;
#X msg 242 222 3;
#X obj 92 31 inlet;
#X msg 92 73 const 0;
#X obj 92 150 s PTA_\$0;
#X obj 112 101 s MAXTA_\$0;
#X obj 103 125 s CTA_\$0;
#X obj 240 96 array define PTA_\$0 120;
#X connect 0 0 1 0;
#X connect 0 0 6 0;
#X connect 0 0 9 0;
#X connect 1 0 2 0;
#X connect 6 0 7 0;
#X connect 7 0 5 0;
#X connect 9 0 8 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 11 0 14 0;
#X connect 11 0 13 0;
#X restore 278 114 pd init;
#X obj 225 322 outlet;
#X obj 294 322 outlet;
#X connect 0 0 2 1;
#X connect 1 0 7 0;
#X connect 2 0 8 0;
#X connect 2 1 8 1;
#X connect 4 0 6 0;
#X connect 5 0 4 0;
#X connect 7 0 4 0;
#X connect 7 1 10 0;
#X connect 7 2 2 0;
#X connect 7 3 4 1;
#X connect 7 3 11 0;
#X connect 8 0 5 0;
#X connect 10 0 12 0;
#X connect 10 1 13 0;
#X restore 402 163 pd weight;
#X obj 190 172 array set \$0-MAXTA;
#X obj 173 202 array set \$0-CTA;
#X msg 208 107 1 0.9 0.8;
#X text 529 225 CTA;
#X text 568 193 MAXTA;
#X obj 453 193 array set \$0-MAXTA;
#X obj 427 224 array set \$0-CTA;
#X obj 402 253 print PTA;
#X connect 0 0 1 0;
#X connect 1 0 8 0;
#X connect 1 1 18 0;
#X connect 8 0 9 0;
#X connect 9 0 5 0;
#X connect 9 1 17 0;
#X connect 9 2 16 0;
#X connect 10 0 13 0;
#X connect 11 0 15 0;
#X connect 12 0 15 1;
#X connect 13 0 11 0;
#X connect 13 1 12 0;
#X connect 15 0 23 0;
#X connect 15 1 22 0;
#X connect 15 2 21 0;
#X connect 18 0 9 1;
