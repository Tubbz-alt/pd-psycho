#N canvas 423 113 696 581 10;
#X declare -path psycho;
#X msg 201 206 1 1 1;
#X obj 102 149 bng 15 250 50 0 empty empty empty 17 7 0 10 -228856
-1 -1;
#N canvas 0 387 450 300 (subpatch) 0;
#X array \$0-salience 120 float 1;
#A 0 0 0 0 0 0 0 0 0 0 0 0.0141372 0 0.015708 0 0.0176715 0.0126563
0.0201959 0.0140625 0 0.158057 0 0.0671572 0.0282743 0.0174893 0.0210938
0.0199877 0.0353429 0.0253126 0.023319 0 0 0.316113 0 0 0 0.0349786
0.0421876 0 0.0706858 0 0.0466381 0 0 0.0632814 0 0 0 0.0699571 0 0
0.424115 0 0 0 0 0.379688 0 0 0 0.419743 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0;
#X coords 0 1 119 0 240 140 1 0 0;
#X restore 244 390 graph;
#X msg 102 206 300 400 500;
#X obj 132 322 array set \$0-salience;
#X obj 102 180 trigger bang bang;
#X obj 132 238 salience;
#X floatatom 177 287 0 0 0 0 - - -;
#X obj 387 151 bng 15 250 50 0 empty empty empty 17 7 0 10 -228856
-1 -1;
#X msg 387 206 300 400 500;
#X msg 485 205 1 0.9 0.8;
#X obj 387 173 trigger bang bang;
#X text 505 239 <= vanilla;
#N canvas 407 23 471 376 salience 0;
#X obj 143 29 inlet;
#X obj 84 29 inlet;
#N canvas 544 79 376 391 YL 0;
#X obj 237 189 list store;
#X obj 124 97 until;
#X obj 124 210 list store;
#X obj 124 125 f;
#X obj 152 125 + 1;
#X msg 171 97 0, f 2;
#X msg 124 154 get \$1 1;
#X obj 124 185 t a a;
#X obj 114 295 list store, f 16;
#X msg 124 266 append \$1;
#X obj 294 38 inlet;
#X obj 67 40 inlet;
#X obj 114 331 outlet;
#X obj 67 331 outlet;
#X obj 67 70 trigger list bang bang bang list;
#N canvas 580 226 601 472 get-Lth 0;
#X obj 133 48 inlet;
#X obj 272 408 outlet;
#X obj 154 184 exp;
#X obj 75 247 expr (3.64 * pow($f1 \, -0.8));
#X obj 154 161 expr -0.6 * pow($f1 - 3.3 \, 2);
#X obj 343 160 expr (pow(10 \, -3) * pow($f1 \, 4));
#X obj 133 109 trigger float float float;
#X obj 154 206 * 6.5;
#X obj 178 299 expr $f1 - $f2 + $f3;
#X text 147 300 Lth;
#X obj 133 76 / 1000;
#X obj 272 346 expr $f2 - $f1;
#X obj 375 59 inlet;
#X text 423 112 dB;
#X obj 373 113 rmstodb;
#X text 280 378 YL;
#X connect 0 0 10 0;
#X connect 2 0 7 0;
#X connect 3 0 8 0;
#X connect 4 0 2 0;
#X connect 5 0 8 2;
#X connect 6 0 3 0;
#X connect 6 1 4 0;
#X connect 6 2 5 0;
#X connect 7 0 8 1;
#X connect 8 0 11 0;
#X connect 10 0 6 0;
#X connect 11 0 1 0;
#X connect 12 0 14 0;
#X connect 14 0 11 1;
#X restore 124 239 pd get-Lth;
#X connect 0 0 15 1;
#X connect 1 0 3 0;
#X connect 2 0 15 0;
#X connect 2 1 1 1;
#X connect 3 0 4 0;
#X connect 3 0 6 0;
#X connect 4 0 3 1;
#X connect 5 0 3 1;
#X connect 6 0 7 0;
#X connect 7 0 2 0;
#X connect 7 1 0 0;
#X connect 8 0 12 0;
#X connect 9 0 8 0;
#X connect 10 0 0 1;
#X connect 11 0 14 0;
#X connect 14 0 13 0;
#X connect 14 1 8 0;
#X connect 14 2 1 0;
#X connect 14 3 8 1;
#X connect 14 3 5 0;
#X connect 14 4 2 1;
#X connect 15 0 9 0;
#X restore 103 149 pd YL;
#X text 145 148 <= Auditory Levels;
#N canvas 254 23 664 794 PTA 0;
#X obj 86 148 until;
#X obj 233 38 inlet;
#X obj 86 38 inlet;
#N canvas 301 23 368 336 set-array 0;
#X obj 147 66 inlet;
#X obj 174 195 array define yl_\$0;
#X obj 174 122 list length;
#X obj 174 143 change;
#X msg 174 168 resize \$1;
#X obj 147 94 t l l;
#X obj 147 221 array set yl_\$0;
#X connect 0 0 5 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 1 0;
#X connect 5 0 6 0;
#X connect 5 1 2 0;
#X restore 233 98 pd set-array;
#N canvas 301 23 363 323 set-array 0;
#X obj 85 52 inlet;
#X obj 214 108 list length;
#X obj 214 129 change;
#X msg 214 177 resize \$1;
#X obj 214 204 array define hz_\$0;
#X obj 149 237 array set hz_\$0;
#X obj 85 80 trigger bang list list;
#X obj 85 286 outlet;
#X obj 235 151 v size_\$0;
#X connect 0 0 6 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 0 8 0;
#X connect 3 0 4 0;
#X connect 6 0 7 0;
#X connect 6 1 5 0;
#X connect 6 2 1 0;
#X restore 86 74 pd set-array;
#X obj 86 100 v size_\$0;
#X obj 139 146 v i_\$0;
#X obj 120 251 until;
#X obj 86 202 v size_\$0;
#X obj 243 309 sel 1;
#N canvas 374 23 390 156 hz2erb 0;
#X obj 75 67 expr 11.17 * log(($f1+0.312)/($f1+14.675)) + 43;
#X obj 75 40 inlet;
#X obj 75 94 outlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X restore 408 385 pd hz2erb;
#X obj 408 357 expr hz_\$0[i_\$0] * 0.001;
#X obj 243 332 trigger bang bang, f 28;
#N canvas 374 23 390 156 hz2erb 0;
#X obj 75 67 expr 11.17 * log(($f1+0.312)/($f1+14.675)) + 43;
#X obj 75 40 inlet;
#X obj 75 94 outlet;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X restore 243 385 pd hz2erb;
#X obj 243 357 expr hz_\$0[j_\$0] * 0.001, f 25;
#X obj 243 414 expr dif_\$0 = abs($f1 - $f2);
#X obj 243 445 < 3;
#X obj 243 466 sel 1;
#X obj 243 534 expr sum_\$0 = sum_\$0 + pow(10 \, $f1/20);
#X obj 73 403 expr 20 * log10(sum_\$0);
#X obj 73 425 max 0;
#X obj 86 123 t f b;
#X msg 168 228 0;
#X obj 168 250 v j_\$0;
#X msg 139 124 0;
#X obj 73 472 max 0;
#X obj 243 504 expr yl_\$0[j_\$0] - kM_\$0 * dif_\$0;
#X obj 73 450 expr yl_\$0[i_\$0] - $f1;
#X obj 193 203 v sum_\$0;
#X msg 193 179 0;
#X obj 120 273 expr j_\$0 = j_\$0 + 1 \; j_\$0 != i_\$0;
#X obj 103 353 expr i_\$0 = i_\$0 + 1;
#X obj 86 173 t b b;
#X obj 73 521 expr 1-exp(-$f1/15);
#X text 37 473 Eq.6;
#X text 39 425 Eq.5;
#X text 37 521 Eq.7;
#X obj 432 414 v dif_\$0;
#X obj 86 224 t b b f b;
#X obj 155 630 ftom;
#X obj 155 608 expr hz_\$0[i_\$0];
#X obj 155 651 expr rint($f1-12);
#X obj 155 673 expr PTA_\$0[$f1] = PTA_\$0[$f1] + $f2;
#X obj 73 567 trigger bang bang float, f 28;
#X obj 73 724 outlet;
#X connect 0 0 32 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 21 0;
#X connect 7 0 30 0;
#X connect 8 0 38 0;
#X connect 9 0 12 0;
#X connect 10 0 15 1;
#X connect 11 0 10 0;
#X connect 12 0 14 0;
#X connect 12 1 11 0;
#X connect 13 0 15 0;
#X connect 14 0 13 0;
#X connect 15 0 16 0;
#X connect 16 0 17 0;
#X connect 17 0 26 0;
#X connect 19 0 20 0;
#X connect 20 0 27 0;
#X connect 21 0 0 0;
#X connect 21 1 24 0;
#X connect 22 0 23 0;
#X connect 24 0 6 0;
#X connect 25 0 33 0;
#X connect 26 0 18 0;
#X connect 27 0 25 0;
#X connect 29 0 28 0;
#X connect 30 1 9 0;
#X connect 32 0 8 0;
#X connect 32 1 29 0;
#X connect 33 0 43 0;
#X connect 38 0 31 0;
#X connect 38 1 19 0;
#X connect 38 2 7 0;
#X connect 38 3 22 0;
#X connect 39 0 41 0;
#X connect 40 0 39 0;
#X connect 41 0 42 0;
#X connect 43 0 44 0;
#X connect 43 1 40 0;
#X connect 43 2 42 1;
#X restore 103 174 pd PTA;
#N canvas 442 88 477 310 init 0;
#X obj 281 170 loadbang;
#X msg 281 196 12;
#X obj 281 221 v kM_\$0;
#X obj 240 120 array define MAXTA_\$0 120;
#X obj 240 72 array define CTA_\$0 120;
#X obj 338 239 v ncats_\$0;
#X msg 338 194 12;
#X obj 338 216 * 10;
#X obj 242 245 v kT_\$0;
#X msg 242 222 3;
#X obj 92 31 inlet;
#X msg 92 73 const 0;
#X obj 92 180 s PTA_\$0;
#X obj 112 131 s MAXTA_\$0;
#X obj 103 155 s CTA_\$0;
#X obj 240 96 array define PTA_\$0 120;
#X obj 240 48 array define SAL_\$0 120;
#X obj 122 102 s SAL_\$0;
#X connect 0 0 1 0;
#X connect 0 0 6 0;
#X connect 0 0 9 0;
#X connect 1 0 2 0;
#X connect 6 0 7 0;
#X connect 7 0 5 0;
#X connect 9 0 8 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 11 0 14 0;
#X connect 11 0 13 0;
#X connect 11 0 17 0;
#X restore 154 109 pd init;
#X obj 84 69 t b l b;
#X obj 195 265 v mul_\$0;
#X obj 84 265 array get SAL_\$0;
#X obj 84 235 trigger bang bang;
#X obj 195 289 outlet;
#X obj 84 289 outlet;
#X text 45 290 Eq.16;
#X text 145 174 <= Pure Tone Audibilities (Spectral Pitch Weight);
#N canvas 484 23 871 572 Tone_Salience 0;
#X obj 202 141 until;
#X obj 202 176 f;
#X obj 235 176 + 1;
#X msg 245 140 0;
#X obj 202 115 t f b;
#X obj 202 87 v ncats_\$0;
#X msg 287 144 10;
#X obj 287 171 until;
#X obj 287 220 ftom;
#X obj 202 206 t f f, f 9;
#X obj 474 148 + 12;
#X obj 474 172 mtof;
#X obj 139 43 inlet;
#X obj 139 87 t b b b;
#X obj 203 274 expr MAXTA_\$0[$f1] = max(CTA_\$0[$f1] \, PTA_\$0[$f1])
\; CTA_\$0[$f1] = (sum_\$0*sum_\$0)/kT_\$0;
#X msg 354 141 0;
#X obj 354 171 v n_\$0;
#X obj 404 171 v sum_\$0;
#X obj 287 117 trigger bang bang float;
#X obj 287 243 expr sum_\$0 = sum_\$0 + sqrt(PTA_\$0[rint($f1)-12]/n_\$0)
;
#X obj 158 341 array sum MAXTA_\$0;
#X obj 287 341 array max MAXTA_\$0;
#X obj 272 390 /;
#X obj 158 317 trigger bang bang, f 22;
#X text 236 389 mulX;
#X obj 272 443 pow;
#X msg 307 418 0.5;
#X obj 307 390 loadbang;
#X text 337 418 kS (simultaneity perception parameter): typically 0.5
;
#X text 244 444 mul;
#X obj 307 365 v maxta_\$0;
#X obj 272 472 v mul_\$0;
#X obj 204 419 v mulX_\$0;
#X obj 139 444 until;
#X obj 139 479 f;
#X obj 172 479 + 1;
#X msg 182 443 0;
#X obj 139 418 t f b;
#X obj 139 390 v ncats_\$0;
#X obj 139 506 expr SAL_\$0[$f1] = (MAXTA_\$0[$f1] / maxta_\$0) * (mul_\$0/mulX_\$0)
, f 64;
#X obj 287 197 expr (n_\$0 = n_\$0 + 1) * $f2;
#X text 519 271 <= Pitch Audibilities;
#X text 520 285 <= Complex Tone Audibilities (Virtual Pitch Weight)
;
#X text 330 472 Pitch Multiplicity;
#X text 533 505 <= Tone Salience;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 0 9 0;
#X connect 2 0 1 1;
#X connect 3 0 1 1;
#X connect 4 0 0 0;
#X connect 4 1 3 0;
#X connect 5 0 4 0;
#X connect 6 0 7 0;
#X connect 7 0 40 0;
#X connect 8 0 19 0;
#X connect 9 0 14 0;
#X connect 9 1 18 0;
#X connect 10 0 11 0;
#X connect 11 0 40 1;
#X connect 12 0 13 0;
#X connect 13 0 38 0;
#X connect 13 1 23 0;
#X connect 13 2 5 0;
#X connect 15 0 16 0;
#X connect 15 0 17 0;
#X connect 18 0 6 0;
#X connect 18 1 15 0;
#X connect 18 2 10 0;
#X connect 20 0 22 0;
#X connect 21 0 22 1;
#X connect 21 0 30 0;
#X connect 22 0 25 0;
#X connect 22 0 32 0;
#X connect 23 0 20 0;
#X connect 23 1 21 0;
#X connect 25 0 31 0;
#X connect 26 0 25 1;
#X connect 27 0 26 0;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 34 0 39 0;
#X connect 35 0 34 1;
#X connect 36 0 34 1;
#X connect 37 0 33 0;
#X connect 37 1 36 0;
#X connect 38 0 37 0;
#X connect 40 0 8 0;
#X restore 103 202 pd Tone_Salience;
#X text 248 264 Pitch Multiplicity;
#X text 240 290 Eq.15;
#X connect 0 0 2 1;
#X connect 1 0 6 0;
#X connect 2 0 4 0;
#X connect 2 1 4 1;
#X connect 4 0 14 0;
#X connect 6 0 9 0;
#X connect 6 1 2 0;
#X connect 6 2 5 0;
#X connect 7 0 10 0;
#X connect 8 0 11 0;
#X connect 9 0 8 0;
#X connect 9 1 7 0;
#X restore 422 241 pd salience;
#X obj 422 314 array set \$0-salience;
#X floatatom 485 282 0 0 0 0 - - -;
#X text 190 264 multiplicity;
#X text 496 262 multiplicity;
#X text 78 31 Get the Tone Salience and multiplicity of a Spectrum
(according to Parncutt & Strasburger \, 1994)., f 63;
#X text 79 63 The multiplicity is number of tones consciously perceived
in a sonority. The Tone Salience is the probability of consciously
perceiving a pitch and is given by an array of Pitch Categories.,
f 63;
#X obj 515 57 declare -path psycho;
#X connect 0 0 6 1;
#X connect 1 0 5 0;
#X connect 3 0 6 0;
#X connect 5 0 3 0;
#X connect 5 1 0 0;
#X connect 6 0 4 0;
#X connect 6 1 7 0;
#X connect 8 0 11 0;
#X connect 9 0 13 0;
#X connect 10 0 13 1;
#X connect 11 0 9 0;
#X connect 11 1 10 0;
#X connect 13 0 14 0;
#X connect 13 1 15 0;
